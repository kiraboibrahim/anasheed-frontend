<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <title>Anasheed mp3 download</title>
    <base href="https://kiraboibrahim.github.io/anasheed-frontend/">

    <!-- For localhost>
    <base href="http://localhost/"-->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Anasheed">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
    <meta name="author" content="Kirabo Ibrahim">
    <meta property="og:title" content="Anasheed artists, anasheed tracks">
    <meta property="og:type" content="website">
    <meta property="og:image" content="icon-512x512.png">
    <meta property="og:url" content="singers.html">
    <meta name="og:description" content="Listen and download all your favorite tracks for anasheed artists.">
    <meta name="theme-color" content="#ffffff">
    <meta name="description" content="Listen and download all your favorite tracks for anasheed artists.">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Anasheed">


    <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="anasheed.webmanifest" />


    <!-- Open Sans font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- Google Material Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="css/reuse.css">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/audio-player.css">
    <link rel="stylesheet" href="css/singers.css">

    <!--  Javascript -->
    <script defer src="js/config.js"></script>
    <script defer src="js/audio-player.js"></script>
    <script defer src="js/common.js"></script>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script defer src="js/lazyloading.js"></script>
    <!-- FETCH SCRIPT -->
    <script defer src="js/fetch.js"></script>
    <script defer src="js/render.js"></script>
    <script defer src="js/nav.js"></script>

    <!-- Service workers -->
    <script async src="sw_reg.js"></script>
    <script async src="sw.js"></script>

    <script defer>
      $(document).ready(function () {
        let location = document.location.href;
        let id_match = location.match(/.*\?artist=(?<id>\d+).*/);
        let id = null;
        if (id_match) {
          // Retrieve the artist id
          id = id_match.groups.id;
          let singer_tracks_url = `${HOST}/artists/${id}/tracks`;
          let singer_detail_url = `${HOST}/artists/${id}`;
          let tracks_article = $(".tracks");

          function share_artist() {
            if (navigator.share) {
              navigator.share(
                {
                  title: document.title,
                  url: document.location.href,
                }
              ).then(function () {
                console.log("You are the people who grow this community, thank you very much");
              }).catch(function (error) {
                console.log("An error has occured, but thank you for the interest");
              }); // end navigator.share
            } else {
              // Browser doesnot support the web share api
              console.log("No support for web share api");
            }
          } // End share_artist

          fetch_data(singer_detail_url)
          .then(function (data) {
            $(".artist-info__name").text(data.name)
            $(".num-songs").text(data.num_songs);
            $(".artist-info__image").css("background-image", `url(${ARTIST_IMAGES_URL}/${data.image})`);
          }); // End fetch_data

          fetch_data(singer_tracks_url)
          .then(function (data) {
            render_songs($("#media-wrapper"), data, $("#track-template").html(), false);
            // Turn off the loading gif
            tracks_article.attr("data-loading", "false");
          }); // End fetch_data

            $(".artist-info__share").click(function () {
              share_artist();
            }); // End click

            $("body").on("click", ".track-template__play", play_song);
            // Capture the click event for download in order to increment the downloads for the track
            $("body").on("click", ".track-template__download", count_download);
        } else {
          document.location.href="singers.html"; // Redirect to the singers page if not artist parameter was given
        }
      }); // End ready
    </script>

    <style>
      .artist-info {
        display: flex;
        border: 1px solid #ededed;
        box-shadow: 0 0 3px #ededed;
        margin-bottom: 20px;
      }
      .artist-info__name {
        font-size: .9em;
      }
      .artist-info__image {
        flex: 0 1 120px;
        height: 110px;
        margin-right: 10px;
        background-repeat: no-repeat;
        background-size: cover;
      }
      .artist-info__num-songs {
        font-size: .8em;
        color: gray;
      }

    </style>
  </head>
  <body data-nav-open="false">
    <!-- Common to every page -->
    <header class="m-logo">
      <a href="index.html"><img class="m-logo__img" src="images/logo.png" alt="Website Logo"></a>
    </header>

    <nav class="m-nav navigation h-sticky">
      <div class="navigation-overlay"></div>
      <span class="btn material-icons md-light m-nav__open-nav">menu</span>
      <ul class="m-nav__menu  navigation__menu">
        <i class="btn material-icons m-nav__close-nav">close</i>
        <li class="m-nav__item"><a href="index.html" class="m-nav__link"><i class="material-icons nav-icon">home</i> HOME</a></li>
        <li class="m-nav__item m-nav__item--is-active"><a href="singers.html" class="m-nav__link"><i class="material-icons nav-icon">library_music</i> ARTISTS</a></li>
        <li class="m-nav__item"><a href="about.html" class="m-nav__link"><i class="material-icons nav-icon">info</i> ABOUT</a></li>
      </ul>
      <form class="search-form" action="#">
          <input class="search-form__input h-input-float" type="text" name="query" placeholder="Search songs, artists">
          <button type="submit" class="search-form__btn-submit">
            <img src="images/search.png" style="width: 14px">
          </button>
      </form>
      <div class="user-profile">
        <button class="desktop-signin-btn user-profile__btn-signin btn btn-primary px-3 rounded-0">SIGN IN</button>
        <button class="mobile-signin-btn user-profile__btn-signin"><img class="mobile-signin-btn__img" src="images/login.png" alt="login"></button>
      </div>
    </nav>
    <!-- End of every Common Element -->

    <!-- Singer Template -->
    <script type="text/template" id="singer-template">
      <div class="m-media media singer singer-template">
        <div class="m-media__image media__image singer__image singer-template__image {{lazy}}" data-src="{{lazy_image}}" style="background-image: url({{image}})"></div>
        <div class="m-media__body singer__info singer-template__info">
          <h2 class="media__name singer__name singer-template__name"> <a class="media__link singer-template__link singer__link" href="{{detail_url}}">{{name}}</a></h2>
          <span class="singer__num-songs singer-template__num-songs d-block mb-3">{{num_songs}} Clips</span>
          <a style="font-size: .85em;" href="{{tracks_url}}" class="singer-template__show-songs-link btn btn-sm btn-danger rounded-0">Show Songs</a>
        </div>
      </div>
    </script>

    <!-- Track Template -->
    <script type="text/template" id="track-template">
      <div class="m-media media track track-template">
        <!-- A track component -->
        <div class="m-media__image media__image track__album-art track-template__album-art"><!-- Album art --></div>
        <div class="m-media__body track__info track-template__info">
          <h2 class="media__name track__name track-template__name"><a class="media__link track-template__link track__link" href="javascript:void();">{{name}}</a></h2>
          <span class="track__listens track-template__listens d-block mb-3">{{listeners}} Listerners</span>
          <a style="font-size: .85em;" href="{{play_url}}" class="track-template__play track__play btn btn-success">Play</a>
          <a style="font-size: .85em;" href="{{download_url}}" target="_blank" class="track-template__download track__download btn btn-outline-danger">Download</a>
        </div>
      </div>
    </script>
    <!-- INLINE ARTIST TEMPLATE -->
    <script type="text/template" id="inline-artist-template">
      <div class="m-media m-media--inline media artist artist-template">
          <div class="m-media__img media__image artist__image artist-template__image {{lazy}}", data-src="{{lazy_image}}">
              <!-- Singer image, will use a background image instead of img tag -->
          </div>
          <h2 class="m-media__body media__name artist__name artist-template__name text-truncate"><a class="artist-template__link media__link artist__link" href="{{detail_url}}">{{name}}</a></h2>
      </div>
    </script>

    <div class="search-modal">
      <div class="search-modal__header">
        <button class="btn search-modal__close"><span class="material-icons">arrow_back</span></button>
        <form class="search-modal__form" action="#">
            <input class="h-input-float search-modal__input" type="text" name="query" placeholder="Search tracks, artists" required>
            <button type="submit" class="search-modal__submit-btn">
              <img src="images/search.png" style="width: 14px">
            </button>
        </form>
      </div>
      <div class="search-modal__body" data-loading="false" data-open="false">
        <div class="search-modal__filters">
          <h1 class="search-modal__filter-title">Filters</h1>
          <label style="display: inline-block; margin-right: 20px;">
            <input id="search-artists" type="radio" value="artists" name="search-context">
            Artists
          </label>
          <label>
            <input id="search-tracks" type="radio" value="tracks" name="search-context" checked>
            Tracks
          </label>
        </div>
        <h1 class="search-modal__search-results-title h-hide">Results for <i class="q"></i></h1>
        <div class="search-modal__search-results l-table"></div>
        <div class="search-modal__loading"></div>
      </div>
    </div>

    <div class="m-audio-player m-audio-player--is-minimized" data-playing-state="false">
      <div class="m-audio-player__header">
        <button class="material-icons btn m-audio-player__minimize" style="font-size: 32px;">expand_more</button>
        <div class="m-audio-player__album-art-wrapper">
          <div class="m-audio-player__album-art">
          </div>
        </div>
        <h2 class="m-audio-player__current-track-name">No song playing</h2>
      </div>
      <div class="m-audio-player__controls-wrapper">
        <div class="m-audio-player__progress">
          <div class="m-audio-player__seek-slider-container">
            <input class="m-audio-player__seek-slider" type="range" min="0" max="100" value="0">
          </div>
          <div class="m-audio-player__time">
            <span class="m-audio-player__played-time">00:00</span>
            <span class="m-audio-player__duration">--:--</span>
          </div>
        </div>
        <div class="m-audio-player__controls">
          <div class="m-audio-player__prev"><span class="material-icons m-audio-player__prev-btn">skip_previous</span></div>
          <div class="m-audio-player__play"><span class="material-icons m-audio-player__play-btn">play_arrow</span></div>
          <div class="m-audio-player__next"><span class="material-icons m-audio-player__next-btn">skip_next</span></div>
        </div>
      </div>
    </div>


    <main>
      <div class="artist-info">
        <div class="artist-info__image" style="background-image: url(http://192.168.43.54:8000/static/anasheed/images/artists/{{ image }});"></div>
        <div style="display: flex; flex-direction: column; padding: 5px;">
          <h2 class="artist-info__name"><!-- {{ name }} --></h2>
          <span class="artist-info__num-songs d-block"><span class="num-songs"><!-- {{ num_songs }} --></span> Clips</span>
          <div style="margin-top: auto;">
            <button class="btn btn-sm btn-primary artist-info__share">SHARE</button>
          </div>
        </div>
      </div>
      <article class="article singers tracks" data-loading="true">
        <header class="article__header d-flex align-items-center">
          <h2 class="article__title singers__title tracks__title">Tracks</h2>
        </header>

        <div class="article__body l-table media-wrapper" id="media-wrapper"></div>
        <!-- loading div, always at the bottom -->
        <div class="loading"></div>
      </article>
    </main>

  </body>
</html>
